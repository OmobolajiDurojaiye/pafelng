<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard | Pafelng</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/admin_dashboard.css') }}"
    />
  </head>
  <body>
    <div class="dashboard-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="logo">
            <i class="fas fa-ship"></i>
            <h2>PafelNG</h2>
          </div>
          <button id="sidebar-toggle" class="sidebar-toggle">
            <i class="fas fa-bars"></i>
          </button>
        </div>

        <div class="sidebar-user">
          <div class="avatar">
            <i class="fas fa-user-circle"></i>
          </div>
          <div class="user-info">
            <h3>{{ admin.name }}</h3>
            <p>Administrator</p>
          </div>
        </div>

        <nav class="sidebar-nav">
          <ul>
            <li class="active">
              <a href="{{ url_for('admin.admin_dashboard') }}"
                ><i class="fas fa-th-large"></i><span>Dashboard</span></a
              >
            </li>

            <li>
              <a href="{{ url_for('admin.vehicle_verification') }}"
                ><i class="fas fa-car"></i><span>Vehicle Verification</span></a
              >
            </li>
            <li>
              <a href="{{ url_for('admin.global_courier') }}"
                ><i class="fas fa-box"></i><span>Global Courier</span></a
              >
            </li>
            <li>
              <a href="#customers"
                ><i class="fas fa-users"></i><span>Customers</span></a
              >
            </li>

            <li>
              <a href="#settings"
                ><i class="fas fa-cog"></i><span>Settings</span></a
              >
            </li>
            <li class="logout">
              <a href="{{ url_for('admin.logout') }}"
                ><i class="fas fa-sign-out-alt"></i><span>Logout</span></a
              >
            </li>
          </ul>
        </nav>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <header class="top-header">
          <div class="header-actions">
            <div class="profile">
              <!-- <a href="#profile">Profile</a> -->
            </div>
          </div>
        </header>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %} {% for category, message in messages %}
        <div class="alert alert-{{ category }}">
          {{ message }}
          <span class="close-alert">&times;</span>
        </div>
        {% endfor %} {% endif %} {% endwith %}

        <div class="dashboard-content">
          <div class="page-header">
            <h1>Admin Dashboard</h1>
            <p>
              Welcome back, {{ admin.name }}! Here's an overview of logistics
              services.
            </p>
          </div>

          <!-- KPI Cards -->
          <div class="kpi-cards">
            <div class="kpi-card">
              <div class="kpi-icon">
                <i class="fas fa-clipboard-check"></i>
              </div>
              <div class="kpi-info">
                <h3>Total Quotes Requests</h3>
                <p class="count">
                  {{ vehicle_verifications|length + global_couriers|length }}
                </p>
              </div>
            </div>
            <div class="kpi-card">
              <div class="kpi-icon">
                <i class="fas fa-spinner"></i>
              </div>
              <div class="kpi-info">
                <h3>Pending</h3>
                <p class="count">
                  {{ vehicle_verifications|selectattr('verification_status',
                  'equalto', 'pending')|list|length +
                  global_couriers|selectattr('status', 'equalto',
                  'pending')|list|length }}
                </p>
              </div>
            </div>
            <div class="kpi-card">
              <div class="kpi-icon">
                <i class="fas fa-check-circle"></i>
              </div>
              <div class="kpi-info">
                <h3>Completed</h3>
                <p class="count">
                  {{ vehicle_verifications|selectattr('verification_status',
                  'equalto', 'approved')|list|length +
                  global_couriers|selectattr('status', 'equalto',
                  'completed')|list|length }}
                </p>
              </div>
            </div>
          </div>

          <!-- Service Section -->
          <div class="section-header">
            <h2>Service Quote Requests</h2>
          </div>

          <div class="service-cards">
            <a
              href="{{ url_for('admin.vehicle_verification') }}"
              class="service-card"
              data-service="vehicle-verification"
            >
              <div class="service-icon">
                <i class="fas fa-car"></i>
              </div>
              <div class="service-info">
                <h3>Vehicle Customs Verification</h3>
                <p>
                  {{ vehicle_verifications|selectattr('verification_status',
                  'equalto', 'pending')|list|length }} pending requests
                </p>
              </div>
              <div class="service-link">
                <i class="fas fa-arrow-right"></i>
              </div>
            </a>

            <a
              href="{{ url_for('admin.global_courier') }}"
              class="service-card"
              data-service="global-courier"
            >
              <div class="service-icon">
                <i class="fas fa-box"></i>
              </div>
              <div class="service-info">
                <h3>Global Courier</h3>
                <p>
                  {{ global_couriers|selectattr('status', 'equalto',
                  'pending')|list|length }} pending requests
                </p>
              </div>
              <div class="service-link">
                <i class="fas fa-arrow-right"></i>
              </div>
            </a>

            <a href="#air" class="service-card" data-service="air-freight">
              <div class="service-icon">
                <i class="fas fa-plane"></i>
              </div>
              <div class="service-info">
                <h3>Air Freight</h3>
                <p>Coming Soon</p>
              </div>
              <div class="service-link">
                <i class="fas fa-arrow-right"></i>
              </div>
            </a>

            <a href="#sea" class="service-card" data-service="sea-freight">
              <div class="service-icon">
                <i class="fas fa-ship"></i>
              </div>
              <div class="service-info">
                <h3>Sea Freight</h3>
                <p>Coming Soon</p>
              </div>
              <div class="service-link">
                <i class="fas fa-arrow-right"></i>
              </div>
            </a>
          </div>

          <!-- Recent Quotes Table -->
          <div class="dashboard-sections">
            <div class="recent-quotes">
              <div class="section-header">
                <h2>Recent Vehicle Verification Requests</h2>
              </div>

              <div class="data-table">
                <table>
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Customer</th>
                      <th>C-Number/Document</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for verification in vehicle_verifications[:5] %}
                    <tr>
                      <td>#VV-{{ verification.id }}</td>
                      <td>
                        <div class="customer-info">
                          <div class="customer-avatar">
                            {{ verification.name[:1] }}
                          </div>
                          <div>{{ verification.name }}</div>
                        </div>
                      </td>
                      <td>
                        {{ verification.c_number if verification.c_number else
                        'Document Upload' }}
                      </td>
                      <td>
                        {{ verification.created_at.strftime('%b %d, %Y') }}
                      </td>
                      <td>
                        <span
                          class="status {{ verification.verification_status }}"
                        >
                          {{ verification.verification_status.capitalize() }}
                        </span>
                      </td>
                      <td>
                        <div class="actions">
                          <a
                            href="{{ url_for('admin.vehicle_verification_detail', id=verification.id) }}"
                            class="btn-icon"
                            title="View Details"
                          >
                            <i class="fas fa-eye"></i>
                          </a>
                        </div>
                      </td>
                    </tr>
                    {% endfor %} {% if not vehicle_verifications %}
                    <tr>
                      <td colspan="6" class="empty-table">
                        No vehicle verification requests found
                      </td>
                    </tr>
                    {% endif %}
                  </tbody>
                </table>
              </div>
            </div>

            <div class="recent-quotes">
              <div class="section-header">
                <h2>Recent Global Courier Requests</h2>
              </div>

              <div class="data-table">
                <table>
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Customer</th>
                      <th>Courier Company</th>
                      <th>Tracking Number</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for courier in global_couriers[:5] %}
                    <tr>
                      <td>#GC-{{ courier.id }}</td>
                      <td>
                        <div class="customer-info">
                          <div class="customer-avatar">
                            {{ courier.name[:1] }}
                          </div>
                          <div>{{ courier.name }}</div>
                        </div>
                      </td>
                      <td>{{ courier.courier_company }}</td>
                      <td>{{ courier.tracking_number }}</td>
                      <td>{{ courier.created_at.strftime('%b %d, %Y') }}</td>
                      <td>
                        <span class="status {{ courier.status }}"
                          >{{ courier.status.capitalize() }}</span
                        >
                      </td>
                      <td>
                        <div class="actions">
                          <a
                            href="{{ url_for('admin.global_courier_detail', id=courier.id) }}"
                            class="btn-icon"
                            title="View Details"
                          >
                            <i class="fas fa-eye"></i>
                          </a>
                        </div>
                      </td>
                    </tr>
                    {% endfor %} {% if not global_couriers %}
                    <tr>
                      <td colspan="7" class="empty-table">
                        No global courier requests found
                      </td>
                    </tr>
                    {% endif %}
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="{{ url_for('static', filename='js/admin_dashboard.js') }}"></script>
  </body>
</html>
