{% extends "admin/admin_dashboard.html" %} {% block title %}Admin - Customers |
PafelNG{% endblock %} {% block additional_css %}
<link
  href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
  rel="stylesheet"
/>
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/admin_customers.css') }}"
/>
{% endblock %} {% block customers_active %}class="active"{% endblock %} {% block
dashboard_active %}{% endblock %} {% block content %}
<div class="content-header">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h1 class="m-0 text-primary">Customer Management</h1>
      </div>
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
          <li class="breadcrumb-item">
            <a href="{{ url_for('admin.admin_dashboard') }}">Dashboard</a>
          </li>
          <li class="breadcrumb-item active">Customers</li>
        </ol>
      </div>
    </div>
  </div>
</div>

<section class="content">
  <div class="container-fluid">
    <!-- Statistics Cards -->
    <div class="row mb-4">
      <div class="col-lg-3 col-6">
        <div class="info-card">
          <div class="info-card-content">
            <h5>Total Customers</h5>
            <h2>{{ users|length }}</h2>
          </div>
          <div class="info-card-icon">
            <i class="fas fa-users"></i>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-6">
        <div class="info-card">
          <div class="info-card-content">
            <h5>Active Customers</h5>
            <h2>
              {{ users|selectattr('is_active', 'equalto', True)|list|length }}
            </h2>
          </div>
          <div class="info-card-icon">
            <i class="fas fa-user-check"></i>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-6">
        <div class="info-card">
          <div class="info-card-content">
            <h5>Inactive Customers</h5>
            <h2>
              {{ users|selectattr('is_active', 'equalto', False)|list|length }}
            </h2>
          </div>
          <div class="info-card-icon">
            <i class="fas fa-user-slash"></i>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-6">
        <div class="info-card">
          <div class="info-card-content">
            <h5>New This Month</h5>
            <h2>
              {{ users|selectattr('created_at.month', 'equalto',
              this_month)|selectattr('created_at.year', 'equalto',
              this_year)|list|length }}
            </h2>
          </div>
          <div class="info-card-icon">
            <i class="fas fa-user-plus"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Search and Filter -->
    <div class="card customer-search-card mb-4">
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <div class="input-group">
              <input
                type="text"
                class="form-control"
                id="customerSearch"
                placeholder="Search customers..."
              />
              <div class="input-group-append">
                <button class="btn btn-primary" type="button">
                  <i class="fas fa-search"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="d-flex justify-content-end">
              <select
                id="sortOptions"
                class="form-control mr-2"
                style="width: auto"
              >
                <option value="name">Sort by Name</option>
                <option value="date">Sort by Date</option>
                <option value="requests">Sort by Requests</option>
              </select>
              <select
                id="statusFilter"
                class="form-control"
                style="width: auto"
              >
                <option value="all">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
              </select>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Customers Table -->
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">All Customers</h3>
      </div>
      <div class="card-body table-responsive p-0">
        <table class="table table-hover text-nowrap" id="customersTable">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Email</th>
              <th>Joined Date</th>
              <th>Status</th>
              <th>Total Requests</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for user in users %}
            <tr class="customer-row" data-userid="{{ user.id }}">
              <td>{{ user.id }}</td>
              <td>{{ user.name }}</td>
              <td>{{ user.email }}</td>
              <td>{{ user.created_at.strftime('%d %b, %Y') }}</td>
              <td>
                {% if user.is_active %}
                <span class="badge badge-success">Active</span>
                {% else %}
                <span class="badge badge-danger">Inactive</span>
                {% endif %}
              </td>
              <td>{{ user_stats[user.id]['total_requests'] }}</td>
              <td>
                <button
                  class="btn btn-sm btn-primary view-details-btn"
                  data-userid="{{ user.id }}"
                >
                  <i class="fas fa-eye"></i> View
                </button>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<!-- Customer Details Modal -->
<div
  class="modal fade"
  id="customerDetailsModal"
  tabindex="-1"
  role="dialog"
  aria-labelledby="customerDetailsModalLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="customerDetailsModalLabel">
          Customer Details
        </h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="customer-profile-header">
          <div class="row">
            <div class="col-md-6">
              <h3 class="customer-name">Customer Name</h3>
              <p class="customer-email">
                <i class="fas fa-envelope"></i> <span></span>
              </p>
              <p class="customer-joined">
                <i class="fas fa-calendar-alt"></i> Joined: <span></span>
              </p>
            </div>
            <div class="col-md-6">
              <div class="customer-stats">
                <div class="stat-item">
                  <span class="stat-value" id="vehicleRequestCount">0</span>
                  <span class="stat-label">Vehicle Verifications</span>
                </div>
                <div class="stat-item">
                  <span class="stat-value" id="courierRequestCount">0</span>
                  <span class="stat-label">Global Couriers</span>
                </div>
                <div class="stat-item">
                  <span class="stat-value" id="airFreightCount">0</span>
                  <span class="stat-label">Air Freights</span>
                </div>
                <div class="stat-item">
                  <span class="stat-value" id="seaFreightCount">0</span>
                  <span class="stat-label">Sea Freights</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <ul class="nav nav-tabs" id="customerDetailsTabs" role="tablist">
          <li class="nav-item">
            <a
              class="nav-link active"
              id="vehicle-tab"
              data-toggle="tab"
              href="#vehicle"
              role="tab"
              >Vehicle Verifications</a
            >
          </li>
          <li class="nav-item">
            <a
              class="nav-link"
              id="courier-tab"
              data-toggle="tab"
              href="#courier"
              role="tab"
              >Global Couriers</a
            >
          </li>
          <li class="nav-item">
            <a
              class="nav-link"
              id="air-tab"
              data-toggle="tab"
              href="#air"
              role="tab"
              >Air Freights</a
            >
          </li>
          <li class="nav-item">
            <a
              class="nav-link"
              id="sea-tab"
              data-toggle="tab"
              href="#sea"
              role="tab"
              >Sea Freights</a
            >
          </li>
        </ul>

        <div class="tab-content mt-3" id="customerDetailsTabsContent">
          <div class="tab-pane fade show active" id="vehicle" role="tabpanel">
            <div class="table-responsive" id="vehicleVerificationsTable">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Date</th>
                    <th>C-Number</th>
                    <th>Phone</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Will be populated via JavaScript -->
                </tbody>
              </table>
            </div>
            <div class="no-data-message" id="noVehicleData">
              <div class="empty-state">
                <i class="fas fa-car-side fa-3x"></i>
                <p>No vehicle verification requests found</p>
              </div>
            </div>
          </div>

          <div class="tab-pane fade" id="courier" role="tabpanel">
            <div class="table-responsive" id="globalCouriersTable">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Date</th>
                    <th>Company</th>
                    <th>Tracking Number</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Will be populated via JavaScript -->
                </tbody>
              </table>
            </div>
            <div class="no-data-message" id="noCourierData">
              <div class="empty-state">
                <i class="fas fa-box fa-3x"></i>
                <p>No global courier requests found</p>
              </div>
            </div>
          </div>

          <div class="tab-pane fade" id="air" role="tabpanel">
            <div class="table-responsive" id="airFreightsTable">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Airwaybill</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Will be populated via JavaScript -->
                </tbody>
              </table>
            </div>
            <div class="no-data-message" id="noAirData">
              <div class="empty-state">
                <i class="fas fa-plane fa-3x"></i>
                <p>No air freight requests found</p>
              </div>
            </div>
          </div>

          <div class="tab-pane fade" id="sea" role="tabpanel">
            <div class="table-responsive" id="seaFreightsTable">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>ID</th>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Tracking Number</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Will be populated via JavaScript -->
                </tbody>
              </table>
            </div>
            <div class="no-data-message" id="noSeaData">
              <div class="empty-state">
                <i class="fas fa-ship fa-3x"></i>
                <p>No sea freight requests found</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>
{% endblock %} {% block additional_scripts %}
<script src="{{ url_for('static', filename='js/admin_customers.js') }}"></script>
{% endblock %}
